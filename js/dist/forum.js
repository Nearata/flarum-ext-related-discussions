(()=>{var t={n:s=>{var o=s&&s.__esModule?()=>s.default:()=>s;return t.d(o,{a:o}),o},d:(s,o)=>{for(var i in o)t.o(o,i)&&!t.o(s,i)&&Object.defineProperty(s,i,{enumerable:!0,get:o[i]})},o:(t,s)=>Object.prototype.hasOwnProperty.call(t,s),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},s={};(()=>{"use strict";function o(t,s){return o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,s){return t.__proto__=s,t},o(t,s)}t.r(s);const i=flarum.core.compat["forum/app"];var n=t.n(i),e=function(){function t(t){this.discussionId=void 0,this.loading=void 0,this.data=void 0,this.discussionId=t,this.loading=!0,this.data=[]}var s=t.prototype;return s.load=function(){var t=this;n().store.find("discussions",{"filter[nearataRelatedDiscussions]":this.discussionId}).then((function(s){var o;(o=t.data).push.apply(o,s),t.loading=!1,m.redraw()}))},s.isLoading=function(){return this.loading},s.getData=function(){return this.data},t}();const a=flarum.core.compat["common/Component"];var r=t.n(a);const c=flarum.core.compat["common/components/LoadingIndicator"];var u=t.n(c);const d=flarum.core.compat["common/components/Placeholder"];var l=t.n(d);const p=flarum.core.compat["forum/components/DiscussionListItem"];var f=t.n(p),h=function(t){var s,i;function a(){for(var s,o=arguments.length,i=new Array(o),n=0;n<o;n++)i[n]=arguments[n];return(s=t.call.apply(t,[this].concat(i))||this).relatedDiscussionState=void 0,s.discussionId=void 0,s.position=void 0,s}i=t,(s=a).prototype=Object.create(i.prototype),s.prototype.constructor=s,o(s,i);var r=a.prototype;return r.oninit=function(s){t.prototype.oninit.call(this,s),this.position=this.attrs.position,this.relatedDiscussionState=new e(this.attrs.discussionId),this.relatedDiscussionState.load()},r.currentStatusElement=function(){return this.relatedDiscussionState.isLoading()?m(u(),null):this.relatedDiscussionState.getData().length?this.relatedDiscussionState.getData().map((function(t,s){return m("li",{"data-id":t.id(),role:"article","aria-setsize":"-1","aria-posinset":s},m(f(),{discussion:t,params:{}}))})):m(l(),{text:n().translator.trans("nearata-related-discussions.forum.no_results")})},r.view=function(){return m("div",{class:"DiscussionList nearataRelatedDiscussions position"+this.position},m("h3",{class:"h3 DiscussionList-title"},n().translator.trans("nearata-related-discussions.forum.discussion_list_title")),m("ul",{class:"DiscussionList-discussions",role:"feed"},this.currentStatusElement()))},a}(r());const v=flarum.core.compat["common/extend"],y=flarum.core.compat["forum/components/DiscussionPage"];var D=t.n(y);const g=flarum.core.compat["forum/components/PostStream"];var b=t.n(g);n().initializers.add("nearata-related-discussions",(function(){(0,v.extend)(b().prototype,"view",(function(t){var s=n().forum.attribute("nearataRelatedDiscussionsAllowGuests");if(n().session.user||s){var o,i,e=this.discussion.id(),a=n().forum.attribute("nearataRelatedDiscussionsPosition"),r="nearataRelatedDiscussions";"first_post"===a&&(null==(o=t.children)||o.splice(1,0,m(h,{key:r,discussionId:e,position:1}))),"last_post"===a&&(null==(i=t.children)||i.splice(t.children.length-1,0,m(h,{key:r,discussionId:e,position:2})))}})),(0,v.extend)(D().prototype,"mainContent",(function(t){var s,o=n().forum.attribute("nearataRelatedDiscussionsAllowGuests");if(n().session.user||o){var i=null==(s=this.discussion)?void 0:s.id();"reply_block"===n().forum.attribute("nearataRelatedDiscussionsPosition")&&t.add("nearataRelatedDiscussions",m(h,{discussionId:i,position:3}))}}))}))})(),module.exports=s})();
//# sourceMappingURL=forum.js.map