{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@nearata/flarum-ext-related-discussions/webpack/bootstrap","webpack://@nearata/flarum-ext-related-discussions/webpack/runtime/compat get default export","webpack://@nearata/flarum-ext-related-discussions/webpack/runtime/define property getters","webpack://@nearata/flarum-ext-related-discussions/webpack/runtime/hasOwnProperty shorthand","webpack://@nearata/flarum-ext-related-discussions/webpack/runtime/make namespace object","webpack://@nearata/flarum-ext-related-discussions/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@nearata/flarum-ext-related-discussions/external root \"flarum.core.compat['forum/app']\"","webpack://@nearata/flarum-ext-related-discussions/./src/forum/states/RelatedDiscussionState.ts","webpack://@nearata/flarum-ext-related-discussions/external root \"flarum.core.compat['common/Component']\"","webpack://@nearata/flarum-ext-related-discussions/external root \"flarum.core.compat['common/components/LoadingIndicator']\"","webpack://@nearata/flarum-ext-related-discussions/external root \"flarum.core.compat['common/components/Placeholder']\"","webpack://@nearata/flarum-ext-related-discussions/external root \"flarum.core.compat['forum/components/DiscussionListItem']\"","webpack://@nearata/flarum-ext-related-discussions/./src/forum/components/RelatedDiscussionList.tsx","webpack://@nearata/flarum-ext-related-discussions/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@nearata/flarum-ext-related-discussions/external root \"flarum.core.compat['common/extend']\"","webpack://@nearata/flarum-ext-related-discussions/external root \"flarum.core.compat['forum/components/PostStream']\"","webpack://@nearata/flarum-ext-related-discussions/./src/forum/index.ts"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","import Discussion from \"flarum/common/models/Discussion\";\nimport app from \"flarum/forum/app\";\n\nexport default class RelatedDiscussionState {\n  discussionId: number;\n  loading: boolean;\n  data: Array<Discussion>;\n\n  constructor(discussionId: number) {\n    this.discussionId = discussionId;\n    this.loading = true;\n    this.data = [];\n  }\n\n  load(): void {\n    app.store\n      .find(\"discussions\", {\n        \"filter[nearataRelatedDiscussions]\": this.discussionId,\n      })\n      .then((r: any) => {\n        this.data.push(...r);\n\n        this.loading = false;\n\n        m.redraw();\n      });\n  }\n\n  isLoading(): boolean {\n    return this.loading;\n  }\n\n  getData(): Array<Discussion> {\n    return this.data;\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Component'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LoadingIndicator'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Placeholder'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionListItem'];","import RelatedDiscussionState from \"../states/RelatedDiscussionState\";\nimport Component from \"flarum/common/Component\";\nimport LoadingIndicator from \"flarum/common/components/LoadingIndicator\";\nimport Placeholder from \"flarum/common/components/Placeholder\";\nimport app from \"flarum/forum/app\";\nimport DiscussionListItem from \"flarum/forum/components/DiscussionListItem\";\nimport type Mithril from \"mithril\";\n\nexport default class RelatedDiscussionList extends Component {\n  relatedDiscussionState!: RelatedDiscussionState;\n  discussionId!: number;\n  position!: number;\n\n  oninit(vnode: Mithril.Vnode<this>) {\n    super.oninit(vnode);\n\n    this.position = this.attrs.position;\n\n    this.relatedDiscussionState = new RelatedDiscussionState(\n      this.attrs.discussionId\n    );\n    this.relatedDiscussionState.load();\n  }\n\n  view() {\n    const allowGuests = app.forum.attribute(\n      \"nearataRelatedDiscussionsAllowGuests\"\n    );\n\n    if (!app.session.user && !allowGuests) {\n      return;\n    }\n\n    if (this.relatedDiscussionState.isLoading()) {\n      return <LoadingIndicator />;\n    }\n\n    return (\n      <div\n        class={`DiscussionList nearataRelatedDiscussions position${this.position}`}\n      >\n        <h3 class=\"h3 DiscussionList-title\">\n          {app.translator.trans(\n            \"nearata-related-discussions.forum.discussion_list_title\"\n          )}\n        </h3>\n        <ul class=\"DiscussionList-discussions\" role=\"feed\">\n          {this.relatedDiscussionState.getData().length ? (\n            this.relatedDiscussionState.getData().map((discussion, index) => {\n              return (\n                <li\n                  data-id={discussion.id()}\n                  role=\"article\"\n                  aria-setsize=\"-1\"\n                  aria-posinset={index}\n                >\n                  <DiscussionListItem discussion={discussion} params={{}} />\n                </li>\n              );\n            })\n          ) : (\n            <Placeholder\n              text={app.translator.trans(\n                \"nearata-related-discussions.forum.no_results\"\n              )}\n            />\n          )}\n        </ul>\n      </div>\n    );\n  }\n}\n","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/PostStream'];","import RelatedDiscussionList from \"./components/RelatedDiscussionList\";\nimport { extend } from \"flarum/common/extend\";\nimport app from \"flarum/forum/app\";\nimport PostStream from \"flarum/forum/components/PostStream\";\n\napp.initializers.add(\"nearata/related-discussions\", () => {\n  extend(PostStream.prototype, \"view\", function (element) {\n    const discussionId = this.discussion.id();\n    const position: string = app.forum.attribute(\n      \"nearataRelatedDiscussionsPosition\"\n    );\n\n    if (position === \"first_post\") {\n      element.children.splice(\n        1,\n        0,\n        m(RelatedDiscussionList, { discussionId, position: 1 })\n      );\n    }\n\n    if (position === \"last_post\") {\n      element.children.splice(\n        element.children.length - 1,\n        0,\n        m(RelatedDiscussionList, { discussionId, position: 2 })\n      );\n    }\n  });\n});\n"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","_setPrototypeOf","p","setPrototypeOf","bind","__proto__","flarum","core","compat","RelatedDiscussionState","discussionId","loading","data","this","load","app","then","r","push","m","redraw","isLoading","getData","RelatedDiscussionList","subClass","superClass","relatedDiscussionState","position","create","constructor","oninit","vnode","attrs","view","allowGuests","class","role","length","map","discussion","index","id","params","text","Component","extend","PostStream","element","children","splice"],"sourceRoot":""}